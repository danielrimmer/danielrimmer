const formatStepNumber=(value)=>{const safe=Math.max(0,Math.round(Number(value)||0));return safe<10?`0${safe}`:String(safe);};const animateStepValue=(el,target,options={})=>{if(!el)return;const{duration=600,from}=options;const startValue=typeof from==='number'?from:Number(el.textContent.replace(/[^0-9]/g,''))||0;const to=Math.max(0,Math.round(Number(target)||0));if(duration<=0){el.textContent=formatStepNumber(to);return;}const startTime=performance.now();const step=(now)=>{const progress=Math.min((now-startTime)/duration,1);const eased=progress<1?1-Math.pow(1-progress,3):1;const current=startValue+(to-startValue)*eased;el.textContent=formatStepNumber(current);if(progress<1)requestAnimationFrame(step);};requestAnimationFrame(step);};(function(){const header=document.querySelector('.site-header');const offset=()=>(header?header.offsetHeight+8:0);const scrollToEl=(el)=>{if(!el)return;if(el.id==='home'||el.id==='hero'){window.scrollTo({top:0,behavior:'smooth'});return;}const sectionsWithoutOffset=['about','contact','process-v1','key-benefits','services','bonus-services'];const shouldShowFromTop=sectionsWithoutOffset.includes(el.id);const sidebarActive=header?.classList.contains('sidebar-mode');const scrollOffset=sidebarActive||shouldShowFromTop?0:offset();const top=el.getBoundingClientRect().top+window.scrollY-scrollOffset;window.scrollTo({top,behavior:'smooth'});};document.querySelectorAll('a[href^="#"]').forEach((a)=>{a.addEventListener('click',(e)=>{const id=a.getAttribute('href');if(!id||id==='#'||id.length<2)return;const target=document.querySelector(id);if(target){e.preventDefault();scrollToEl(target);document.documentElement.classList.remove('nav-open');header?.querySelector('.nav-toggle')?.setAttribute('aria-expanded','false');}});});})();(function(){const els=document.querySelectorAll('.reveal');if(!('IntersectionObserver' in window)||els.length===0){els.forEach((el)=>el.classList.add('visible'));return;}const io=new IntersectionObserver((entries)=>{for(const entry of entries){if(entry.isIntersecting){entry.target.classList.add('visible');io.unobserve(entry.target);}}},{rootMargin:'0px 0px-10%0px',threshold:0.1});els.forEach((el)=>io.observe(el));})();(function(){const toggle=document.querySelector('.nav-toggle');if(!toggle)return;document.documentElement.classList.remove('nav-open');toggle.addEventListener('click',()=>{const open=document.documentElement.classList.toggle('nav-open');toggle.setAttribute('aria-expanded',String(open));});const menu=document.querySelector('.mobile-menu');const panel=menu?.querySelector('.mobile-menu-panel');if(menu&&panel){menu.addEventListener('click',(e)=>{if(!panel.contains(e.target)){document.documentElement.classList.remove('nav-open');toggle.setAttribute('aria-expanded','false');}});}const mq=window.matchMedia('(max-width:980px)');const ensureClosed=()=>{if(!mq.matches&&document.documentElement.classList.contains('nav-open')){document.documentElement.classList.remove('nav-open');toggle.setAttribute('aria-expanded','false');}};if(typeof mq.addEventListener==='function')mq.addEventListener('change',ensureClosed);else if(typeof mq.addListener==='function')mq.addListener(ensureClosed);window.addEventListener('orientationchange',ensureClosed);window.addEventListener('resize',ensureClosed);})();(function(){const sections=Array.from(document.querySelectorAll('main section[id]')).filter(sec=>sec.id&&!sec.hasAttribute('hidden'));const links=new Map(Array.from(document.querySelectorAll('.nav .nav-links a[href^="#"]')).map((a)=>[a.getAttribute('href'),a]));const onScroll=()=>{const header=document.querySelector('.site-header');const isSidebarMode=header?.classList.contains('sidebar-mode');const viewportMiddle=window.innerHeight/2;const scrollY=window.scrollY;let activeId='#home';let closestSection=null;let closestDistance=Infinity;for(const sec of sections){if(isSidebarMode){const rect=sec.getBoundingClientRect();const sectionMiddle=rect.top+rect.height/2;const distance=Math.abs(sectionMiddle-viewportMiddle);if(distance<closestDistance&&rect.top<viewportMiddle&&rect.bottom>0){closestDistance=distance;closestSection=sec;}}else{const offset=header?.offsetHeight||0;if(sec.offsetTop<=scrollY+offset+100){activeId=`#${sec.id}`;}}}if(isSidebarMode&&closestSection){activeId=`#${closestSection.id}`;}links.forEach((a)=>a.classList.remove('active'));const el=links.get(activeId);if(el)el.classList.add('active');};window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',onScroll);onScroll();})();(function(){const header=document.querySelector('.site-header');const root=document.documentElement;const onReady=()=>document.body.classList.add('is-ready');if(document.readyState==='loading')document.addEventListener('DOMContentLoaded',onReady);else onReady();const heroSection=document.getElementById('hero');const heroSectionHeight=heroSection?.offsetHeight||window.innerHeight;let headerHeight=header?.getBoundingClientRect().height||76;if(header)root.style.setProperty('--header-height',`${Math.round(headerHeight)}px`);let isSidebarMode=false;let sidebarExpandTimeout=null;const isDesktop=()=>window.matchMedia('(min-width:981px)').matches;const onScroll=()=>{if(!header||!heroSection)return;const y=window.scrollY;const navOpen=document.documentElement.classList.contains('nav-open');const measuredHeight=header.getBoundingClientRect().height||headerHeight;if(Math.abs(measuredHeight-headerHeight)>0.5){headerHeight=measuredHeight;root.style.setProperty('--header-height',`${Math.round(headerHeight)}px`);}header.classList.remove('is-solid');if(isDesktop()&&!navOpen){if(y>=50){if(!isSidebarMode){isSidebarMode=true;header.classList.remove('hide','sidebar-collapsing');header.classList.add('sidebar-mode');if(sidebarExpandTimeout)clearTimeout(sidebarExpandTimeout);sidebarExpandTimeout=setTimeout(()=>{header.classList.add('sidebar-expanded');},800);}}else{if(isSidebarMode){isSidebarMode=false;if(sidebarExpandTimeout)clearTimeout(sidebarExpandTimeout);header.classList.add('sidebar-collapsing');header.classList.remove('sidebar-expanded');setTimeout(()=>{header.classList.remove('sidebar-mode','sidebar-collapsing');},400);}}}else if(!isDesktop()){if(!navOpen&&y>=heroSectionHeight){header.classList.add('hide');header.classList.remove('is-pinned');}else{header.classList.remove('hide');}header.classList.remove('sidebar-mode','sidebar-expanded','sidebar-collapsing');isSidebarMode=false;}};window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',onScroll);onScroll();})();(function(){const bgs=Array.from(document.querySelectorAll('.about .about-bg'));if(!bgs.length)return;const reduce=window.matchMedia('(prefers-reduced-motion:reduce)');if(reduce.matches)return;const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));let ticking=false;const update=()=>{ticking=false;const vh=window.innerHeight||document.documentElement.clientHeight;bgs.forEach((bg)=>{const host=bg.closest('.about')||bg.parentElement;const rect=host.getBoundingClientRect();const centerDelta=rect.top+rect.height/2-vh/2;const offset=clamp(-centerDelta*0.06,-40,40);bg.style.transform=`translateY(${offset}px)scale(1.05)`;});};const onScroll=()=>{if(ticking)return;ticking=true;requestAnimationFrame(update);};window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',onScroll);onScroll();})();(function(){const images=Array.from(document.querySelectorAll('.bonus .bonus-bg-image'));if(!images.length)return;const reduce=window.matchMedia('(prefers-reduced-motion:reduce)');if(reduce.matches)return;const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));let ticking=false;const update=()=>{ticking=false;const vh=window.innerHeight||document.documentElement.clientHeight;images.forEach((img)=>{const host=img.closest('.bonus')||img.parentElement;if(!host)return;const rect=host.getBoundingClientRect();const centerDelta=rect.top+rect.height/2-vh/2;const offsetY=clamp(-centerDelta*0.045,-60,60);const offsetX=clamp(centerDelta*0.02,-30,30);img.style.transform=`translate3d(${offsetX}px,${offsetY}px,0)scale(1.05)`;});};const onScroll=()=>{if(ticking)return;ticking=true;requestAnimationFrame(update);};window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',onScroll);onScroll();})();(function(){const containers=document.querySelectorAll('#hero .hero-media');if(!containers.length)return;containers.forEach((media)=>{const vids=Array.from(media.querySelectorAll('video'));if(vids.length>=2){const[a,b]=vids;[a,b].forEach((v)=>{v.loop=false;v.muted=true;v.playsInline=true;});let current=a;const show=(v)=>{vids.forEach((x)=>x.classList.remove('active'));v.classList.add('active');const p=v.play();if(p&&typeof p.catch==='function')p.catch(()=>{});};const next=()=>{current=current===a?b:a;if(current.readyState>=2)show(current);else current.addEventListener('loadeddata',()=>show(current),{once:true});};[a,b].forEach((v)=>{v.addEventListener('ended',next);v.addEventListener('error',next);});if(a.readyState>=2)show(a);else a.addEventListener('loadeddata',()=>show(a),{once:true});}else if(vids.length===1){const video=vids[0];const alt=media.getAttribute('data-alt')||'';if(!alt)return;const firstSrc=video.currentSrc||video.getAttribute('src')||'';const list=[firstSrc,alt].filter(Boolean).filter((v,i,a)=>a.indexOf(v)===i);if(list.length<2)return;let idx=0;video.loop=false;video.muted=true;const applyZoom=()=>{if(idx===1)video.classList.add('zoomed');else video.classList.remove('zoomed');};const playIndex=(i)=>{idx=i%list.length;video.src=list[idx];applyZoom();const p=video.play();if(p&&p.catch)p.catch(()=>{});};const nextSingle=()=>playIndex((idx+1)%list.length);video.addEventListener('ended',nextSingle);video.addEventListener('error',nextSingle);applyZoom();}});})();(function(){const titleEl=document.querySelector('.animate-title');const subEl=document.querySelector('.hero .hero-copy .sub');const ctaEl=document.querySelector('.hero .hero-cta');const scrollIndicator=document.querySelector('#hero .scroll-indicator');const heroSection=document.getElementById('hero');if(!titleEl||!subEl||!ctaEl)return;const titleText=titleEl.textContent.trim();const subText=subEl.textContent.trim();let lockedHeight=0;const isMobile=()=>window.matchMedia('(max-width:980px)').matches;if(heroSection&&isMobile()){const rect=heroSection.getBoundingClientRect();lockedHeight=Math.ceil(rect.height);heroSection.style.height=`${lockedHeight}px`;}titleEl.textContent='';subEl.textContent='';ctaEl.classList.remove('show');if(scrollIndicator)scrollIndicator.classList.remove('show');const typeText=(el,text,delay)=>new Promise((resolve)=>{const chars=Array.from(text);let i=0;const tick=()=>{el.textContent=chars.slice(0,i++).join('');if(i<=chars.length)setTimeout(tick,delay);else resolve();};tick();});let startedTyping=false;const start=async()=>{if(startedTyping)return;startedTyping=true;await typeText(titleEl,titleText,60);await typeText(subEl,subText,30);ctaEl.classList.add('show');if(scrollIndicator)scrollIndicator.classList.add('show');};if('IntersectionObserver' in window){const hero=document.getElementById('hero');if(!hero){start();return;}const io=new IntersectionObserver((entries)=>{for(const e of entries){if(e.isIntersecting){start();io.disconnect();break;}}},{threshold:0.6});io.observe(hero);setTimeout(start,1200);}else{start();}})();(function(){if(window.matchMedia('(pointer:coarse)').matches)return;const glow=document.createElement('div');glow.className='cursor-glow';document.body.appendChild(glow);let x=window.innerWidth/2,y=window.innerHeight/2;let tx=x,ty=y;let isAnimating=false;let lastMovement=Date.now();const inactivityTimeout=5000;const lerp=(a,b,t)=>a+(b-a)*t;const loop=()=>{if(!isAnimating)return;x=lerp(x,tx,0.18);y=lerp(y,ty,0.18);glow.style.transform=`translate3d(${x}px,${y}px,0)`;requestAnimationFrame(loop);};const handleMouseMove=(e)=>{tx=e.clientX;ty=e.clientY;lastMovement=Date.now();if(!isAnimating){isAnimating=true;loop();}};setInterval(()=>{if(Date.now()-lastMovement>inactivityTimeout&&isAnimating){isAnimating=false;}},inactivityTimeout);window.addEventListener('mousemove',handleMouseMove,{passive:true});const hoverables='a,button,.btn,.project';document.addEventListener('mouseover',(e)=>{if(e.target.closest(hoverables)){glow.style.width='28px';glow.style.height='28px';}});document.addEventListener('mouseout',(e)=>{if(e.target.closest(hoverables)){glow.style.width='18px';glow.style.height='18px';}});})();(function(){const hero=document.querySelector('.hero');const a=document.querySelector('.orb-a');const b=document.querySelector('.orb-b');if(!hero||!a||!b)return;hero.addEventListener('mousemove',(e)=>{const r=hero.getBoundingClientRect();const cx=(e.clientX-r.left)/r.width-0.5;const cy=(e.clientY-r.top)/r.height-0.5;a.style.transform=`translate(${cx*12}px,${cy*12}px)`;b.style.transform=`translate(${cx*-12}px,${cy*-12}px)`;});})();(function(){const section=document.querySelector('section.about');const bg=document.querySelector('.about .about-bg');if(!section||!bg)return;const reduce=window.matchMedia('(prefers-reduced-motion:reduce)');const speed=0.25;let ticking=false;const update=()=>{const rect=section.getBoundingClientRect();const vh=window.innerHeight||document.documentElement.clientHeight;if(rect.bottom<0||rect.top>vh){ticking=false;return;}const offset=-rect.top*speed;bg.style.transform=`translate3d(0,${offset}px,0)`;ticking=false;};const onScroll=()=>{if(reduce.matches){bg.style.transform='translate3d(0,0,0)';return;}if(!ticking){ticking=true;requestAnimationFrame(update);}};window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',onScroll);onScroll();})();(function(){const counters=document.querySelectorAll('[data-count]');if(!counters.length)return;const animate=(el)=>{const target=Number(el.dataset.count);if(!target)return;animateStepValue(el,target,{duration:800,from:1});el.removeAttribute('data-count');};if('IntersectionObserver' in window){const io=new IntersectionObserver((entries,observer)=>{for(const entry of entries){if(entry.isIntersecting){animate(entry.target);observer.unobserve(entry.target);}}},{rootMargin:'0px 0px-10%0px',threshold:0.35});counters.forEach((el)=>io.observe(el));}else{counters.forEach((el)=>animate(el));}})();(function(){const lists=document.querySelectorAll('.process-step-list');if(!lists.length)return;const registerQueryListener=(mq,handler)=>{if(typeof mq.addEventListener==='function')mq.addEventListener('change',handler);else if(typeof mq.addListener==='function')mq.addListener(handler);};lists.forEach((list)=>{const steps=Array.from(list.querySelectorAll('.process-step'));if(!steps.length)return;const section=list.closest('.process');const targetSelector=steps[0].dataset.target;const panel=targetSelector&&section?section.querySelector(targetSelector):null;const numberEl=panel?.querySelector('.detail-number');const titleEl=panel?.querySelector('.detail-title');const textEl=panel?.querySelector('.detail-text');const wallpaperEl=section?.querySelector('.process-bg');const defaultWallpaper=section?.dataset.defaultWallpaper||'';if(panel)panel.setAttribute('tabindex','0');const mobileQuery=window.matchMedia('(max-width:720px)');const isMobile=()=>mobileQuery.matches;let current=steps[0]||null;let currentIndex=0;let hasUnlockedLoop=false;const applyWallpaper=(src)=>{if(!wallpaperEl)return;const image=src||defaultWallpaper;wallpaperEl.style.backgroundImage=image?`url('${image}')`:'';};const applyCardClasses=()=>{const len=steps.length;steps.forEach((step)=>step.classList.remove('card-current','card-prev','card-next','card-hidden'));if(!isMobile())return;const nextIdx=currentIndex===len-1?(hasUnlockedLoop?0:null):currentIndex+1;const prevIdx=hasUnlockedLoop?(currentIndex-1+len)%len:currentIndex>0?currentIndex-1:null;steps.forEach((step,idx)=>{if(idx===currentIndex)step.classList.add('card-current');else if(nextIdx!==null&&idx===nextIdx)step.classList.add('card-next');else if(prevIdx!==null&&idx===prevIdx)step.classList.add('card-prev');else step.classList.add('card-hidden');});};const goRelative=(dir)=>{const len=steps.length;if(dir===1){if(currentIndex<len-1)activate(steps[currentIndex+1]);else if(hasUnlockedLoop)activate(steps[0]);}else if(dir===-1){if(!hasUnlockedLoop)return;const prevIdx=currentIndex===0?len-1:currentIndex-1;activate(steps[prevIdx]);}};const activate=(btn,force=false)=>{if(!btn)return;const detailTitle=btn.dataset.title||btn.textContent.trim();const detailText=btn.dataset.detail||'';const idx=steps.indexOf(btn);const stepIndex=Number(btn.dataset.step)||idx+1;if(idx!==-1){currentIndex=idx;if(idx===steps.length-1)hasUnlockedLoop=true;}if(!isMobile())applyWallpaper(btn.dataset.wallpaper);if(isMobile()){current=btn;steps.forEach((step)=>{const isActive=step===btn;step.classList.toggle('active',isActive);step.setAttribute('aria-selected',String(isActive));step.setAttribute('aria-expanded','true');});if(numberEl)numberEl.textContent=formatStepNumber(stepIndex);applyCardClasses();return;}if(!force&&current===btn&&btn.classList.contains('active'))return;current=btn;steps.forEach((step)=>{const isActive=step===btn;step.classList.toggle('active',isActive);step.setAttribute('aria-selected',String(isActive));step.setAttribute('aria-expanded',String(isActive));});if(panel){panel.classList.add('updating');panel.dataset.activeStep=String(stepIndex);if(titleEl)titleEl.textContent=detailTitle;if(textEl)textEl.textContent=detailText;if(numberEl)animateStepValue(numberEl,stepIndex,{duration:500});setTimeout(()=>panel.classList.remove('updating'),320);}applyCardClasses();};const initialize=()=>{if(isMobile()){const first=steps[0];current=first;currentIndex=0;hasUnlockedLoop=false;steps.forEach((step)=>{const isActive=step===first;step.classList.toggle('active',isActive);step.setAttribute('aria-selected',String(isActive));step.setAttribute('aria-expanded','true');});if(numberEl)numberEl.textContent=formatStepNumber(Number(first.dataset.step)||1);applyWallpaper(first?.dataset.wallpaper);}else{const initial=steps.find((step)=>step.classList.contains('active'))||steps[0];activate(initial,true);}applyCardClasses();};steps.forEach((step,index)=>{const handleHover=()=>{if(!isMobile())activate(step);};step.addEventListener('mouseenter',handleHover);step.addEventListener('mouseover',handleHover);step.addEventListener('pointerenter',handleHover);step.addEventListener('focus',()=>activate(step));step.addEventListener('click',(e)=>{e.preventDefault();activate(step);});step.addEventListener('keydown',(e)=>{if(e.key==='ArrowDown'||e.key==='ArrowRight'){e.preventDefault();const next=steps[(index+1)%steps.length];next.focus();}else if(e.key==='ArrowUp'||e.key==='ArrowLeft'){e.preventDefault();const prev=steps[(index-1+steps.length)%steps.length];prev.focus();}});step.addEventListener('mouseleave',()=>{if(isMobile())return;const active=steps.find((s)=>s.classList.contains('active'))||current;applyWallpaper(active?.dataset.wallpaper);});});let pointerActive=false;let startX=0;let startY=0;const SWIPE_THRESHOLD=40;const getPoint=(event)=>{if('touches' in event&&event.touches.length)return event.touches[0];if('changedTouches' in event&&event.changedTouches.length)return event.changedTouches[0];return event;};const handlePointerDown=(event)=>{if(!isMobile())return;pointerActive=true;const point=getPoint(event);startX=point.clientX;startY=point.clientY;};const handlePointerMove=(event)=>{if(!pointerActive)return;const point=getPoint(event);const dx=point.clientX-startX;const dy=point.clientY-startY;if(Math.abs(dy)>Math.abs(dx)){pointerActive=false;return;}if(Math.abs(dx)>SWIPE_THRESHOLD){pointerActive=false;const isRTL=document.documentElement.getAttribute('dir')==='rtl';const direction=dx<0?1:-1;goRelative(isRTL?-direction:direction);}};const handlePointerUp=()=>{pointerActive=false;};list.addEventListener('pointerdown',handlePointerDown);list.addEventListener('pointermove',handlePointerMove,{passive:true});list.addEventListener('pointerup',handlePointerUp);list.addEventListener('pointercancel',handlePointerUp);list.addEventListener('pointerleave',handlePointerUp);initialize();registerQueryListener(mobileQuery,()=>{initialize();});});})();(function(){const carousels=document.querySelectorAll('[data-process-carousel]');if(!carousels.length)return;carousels.forEach((carousel)=>{const cards=Array.from(carousel.querySelectorAll('.process-card'));if(!cards.length)return;const section=carousel.closest('.process');const controls=section?Array.from(section.querySelectorAll('.carousel-btn')):[];let activeIndex=Math.max(0,cards.findIndex((card)=>card.classList.contains('active')));const clampIndex=(index)=>{if(index<0)return 0;if(index>=cards.length)return cards.length-1;return index;};const ensureVisible=(card)=>{if(!card||typeof card.scrollIntoView!=='function')return;card.scrollIntoView({behavior:'smooth',block:'nearest',inline:'center'});};const setActive=(index,focusCard=false,animate=true)=>{const nextIndex=clampIndex(index);const nextCard=cards[nextIndex];if(!nextCard)return;if(nextIndex===activeIndex&&nextCard.classList.contains('active')&&animate)return;activeIndex=nextIndex;cards.forEach((card,i)=>{const isActive=i===nextIndex;card.classList.toggle('active',isActive);card.setAttribute('aria-expanded',String(isActive));});if(animate){animateStepValue(nextCard.querySelector('.step-num'),Number(nextCard.dataset.step)||nextIndex+1,{duration:500,from:0});}ensureVisible(nextCard);if(focusCard)nextCard.focus();};cards.forEach((card,index)=>{card.addEventListener('click',()=>setActive(index));card.addEventListener('keydown',(e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();setActive(index);}else if(e.key==='ArrowRight'){e.preventDefault();setActive(index+1,true);}else if(e.key==='ArrowLeft'){e.preventDefault();setActive(index-1,true);}});});controls.forEach((btn)=>{btn.addEventListener('click',()=>{const dir=btn.dataset.dir==='prev'?-1:1;setActive(activeIndex+dir,true);});});cards.forEach((card)=>card.setAttribute('aria-expanded',String(card.classList.contains('active'))));setActive(activeIndex,false,false);});})();(function(){const carousels=document.querySelectorAll('[data-bonus-carousel]');if(!carousels.length)return;carousels.forEach((carousel)=>{const cards=Array.from(carousel.querySelectorAll('.carousel-card'));if(!cards.length)return;const wrapper=carousel.closest('.bonus-carousel-wrapper');const prevBtn=wrapper?wrapper.querySelector('.carousel-nav-prev'):null;const nextBtn=wrapper?wrapper.querySelector('.carousel-nav-next'):null;const isRTL=document.documentElement.getAttribute('dir')==='rtl';let currentIndex=0;const updateCarousel=()=>{cards.forEach((card,index)=>{card.classList.remove('active','prev','next','far-prev','far-next');const diff=index-currentIndex;const total=cards.length;let normalizedDiff=diff;if(Math.abs(diff)>total/2){normalizedDiff=diff>0?diff-total:diff+total;}if(normalizedDiff===0){card.classList.add('active');}else if(normalizedDiff===1||normalizedDiff===-total+1){card.classList.add(isRTL?'prev':'next');}else if(normalizedDiff===-1||normalizedDiff===total-1){card.classList.add(isRTL?'next':'prev');}else if(normalizedDiff>1||normalizedDiff<-1){if(normalizedDiff>0){card.classList.add(isRTL?'far-prev':'far-next');}else{card.classList.add(isRTL?'far-next':'far-prev');}}});};const navigate=(direction)=>{currentIndex=(currentIndex+direction+cards.length)%cards.length;updateCarousel();};if(prevBtn){prevBtn.addEventListener('click',()=>navigate(isRTL?1:-1));}if(nextBtn){nextBtn.addEventListener('click',()=>navigate(isRTL?-1:1));}carousel.addEventListener('keydown',(e)=>{if(e.key==='ArrowRight'){e.preventDefault();navigate(isRTL?-1:1);}else if(e.key==='ArrowLeft'){e.preventDefault();navigate(isRTL?1:-1);}});let touchStartX=0;let touchEndX=0;carousel.addEventListener('touchstart',(e)=>{touchStartX=e.changedTouches[0].screenX;},{passive:true});carousel.addEventListener('touchend',(e)=>{touchEndX=e.changedTouches[0].screenX;handleSwipe();},{passive:true});const handleSwipe=()=>{const swipeThreshold=50;const diff=touchStartX-touchEndX;if(Math.abs(diff)>swipeThreshold){if(diff>0){navigate(isRTL?-1:1);}else{navigate(isRTL?1:-1);}}};updateCarousel();});})();(function(){const isDesktop=()=>window.matchMedia('(min-width:981px)').matches;if(!isDesktop())return;const bonusSection=document.querySelector('.bonus#bonus-services');if(!bonusSection)return;const cardsContainer=bonusSection.querySelector('.bonus-cards-mobile');if(!cardsContainer)return;const cards=Array.from(cardsContainer.querySelectorAll('.bonus-card'));if(cards.length<4)return;let ticking=false;const updateCards=()=>{ticking=false;const scrollY=window.scrollY;const bonusRect=bonusSection.getBoundingClientRect();const bonusTop=bonusRect.top+scrollY;const viewportHeight=window.innerHeight;cards.forEach((card,index)=>{const triggerY=bonusTop+(index*120)-viewportHeight*0.5;if(scrollY>=triggerY){card.classList.add('is-visible');}else{card.classList.remove('is-visible');}});};const onScroll=()=>{if(ticking)return;ticking=true;requestAnimationFrame(updateCards);};window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',updateCards);updateCards();})();(function(){const isMobileOrTablet=()=>window.matchMedia('(max-width:980px)').matches;if(!isMobileOrTablet())return;const bonusSection=document.querySelector('.bonus#bonus-services');if(!bonusSection)return;const cardsContainer=bonusSection.querySelector('.bonus-cards-mobile');if(!cardsContainer)return;const cards=Array.from(cardsContainer.querySelectorAll('.bonus-card'));if(!cards.length)return;let ticking=false;const updateCards=()=>{ticking=false;const viewportHeight=window.innerHeight;const headerHeight=document.querySelector('.site-header')?.offsetHeight||76;const scrollY=window.scrollY;cards.forEach((card,index)=>{const cardRect=card.getBoundingClientRect();const cardTop=cardRect.top;const triggerPoint=viewportHeight*0.8;if(cardTop<triggerPoint&&!card.classList.contains('is-visible')){card.classList.add('is-visible');}const stickyTop=headerHeight+20;const stickyBottom=headerHeight+120;if(cardTop>=stickyTop&&cardTop<=stickyBottom){cards.forEach(c=>c.classList.remove('is-active'));card.classList.add('is-active');}else if(cardTop>stickyBottom){card.classList.remove('is-active');}});};const onScroll=()=>{if(ticking)return;ticking=true;requestAnimationFrame(updateCards);};const observer=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){window.addEventListener('scroll',onScroll,{passive:true});updateCards();}else{window.removeEventListener('scroll',onScroll);}});},{rootMargin:'100px'});observer.observe(bonusSection);updateCards();const handleResize=()=>{if(!isMobileOrTablet()){window.removeEventListener('scroll',onScroll);}else{updateCards();}};window.addEventListener('resize',handleResize);const cleanup=()=>{observer.disconnect();window.removeEventListener('scroll',onScroll);window.removeEventListener('resize',handleResize);};window.addEventListener('beforeunload',cleanup);})();(function(){const benefitCards=document.querySelectorAll('.benefit-card');benefitCards.forEach((card)=>{const glowLight=card.querySelector('::before');card.addEventListener('mousemove',(e)=>{const rect=card.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;card.style.setProperty('--light-x',`${x}px`);card.style.setProperty('--light-y',`${y}px`);});card.addEventListener('mouseleave',()=>{card.style.setProperty('--light-x','-150px');card.style.setProperty('--light-y','-150px');});});})();(function(){const cardsWithImages=document.querySelectorAll('.card-with-image');if(!cardsWithImages.length)return;const isTouchDevice=()=>('ontouchstart' in window)||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;const isTabletOrMobile=()=>window.innerWidth<=980;const autoplayVideo=(video)=>{if(!video)return;video.currentTime=0;const playPromise=video.play();if(playPromise&&playPromise.catch){playPromise.catch(()=>{});}};const stopVideo=(video)=>{if(!video)return;video.pause();video.currentTime=0;};cardsWithImages.forEach((card)=>{const video=card.querySelector('.card-video-full');if(!video)return;card.addEventListener('mouseenter',()=>{if(!isTouchDevice())autoplayVideo(video);});card.addEventListener('mouseleave',()=>{if(!isTouchDevice())stopVideo(video);});if(isTabletOrMobile()||isTouchDevice()){const observer=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){autoplayVideo(video);}else{stopVideo(video);}});},{threshold:0.25});observer.observe(card);}});})();(function(){const benefitCards=document.querySelectorAll('.benefit-card');if(!benefitCards.length)return;const typeText=(el,text,delay)=>new Promise((resolve)=>{el.textContent='';const chars=Array.from(text);let i=0;const tick=()=>{el.textContent=chars.slice(0,i++).join('');if(i<=chars.length)setTimeout(tick,delay);else resolve();};tick();});const startTypewriting=async(card)=>{const description=card.querySelector('.card-description');if(!description)return;const text=description.textContent.trim();description.textContent='';await typeText(description,text,30);};const isMobile=()=>window.matchMedia('(max-width:980px)').matches;benefitCards.forEach((card)=>{if(!isMobile()){let hasTyped=false;card.addEventListener('mouseenter',async()=>{if(!hasTyped){hasTyped=true;await startTypewriting(card);}});card.addEventListener('mouseleave',()=>{hasTyped=false;});}});if('IntersectionObserver' in window){const observerOptions={threshold:0.1,rootMargin:'0px',};const observer=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const card=entry.target;const description=card.querySelector('.card-description');if(description&&!description.dataset.typed){description.dataset.typed='true';startTypewriting(card);observer.unobserve(card);}}});},observerOptions);benefitCards.forEach((card)=>{if(isMobile()){observer.observe(card);}});}})();(function(){const isMobileDevice=()=>window.innerWidth<=480;const isTabletDevice=()=>window.innerWidth>480&&window.innerWidth<=1024;const getResponsiveMargin=(mobileVal,tabletVal,desktopVal)=>{if(isMobileDevice())return `${mobileVal}px`;if(isTabletDevice())return `${tabletVal}px`;return `${desktopVal}px`;};(function lazyLoadVideos(){const videos=document.querySelectorAll('video[data-src],video.lazy-video');if(!('IntersectionObserver' in window)||videos.length===0)return;const videoObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const video=entry.target;const sources=video.querySelectorAll('source[data-src]');sources.forEach((source)=>{if(source.dataset.src){source.src=source.dataset.src;delete source.dataset.src;}});if(sources.length===0&&video.dataset.src){const source=document.createElement('source');source.src=video.dataset.src;source.type='video/mp4';video.appendChild(source);delete video.dataset.src;}video.load();videoObserver.unobserve(video);}});},{rootMargin:getResponsiveMargin(30,40,50)});videos.forEach((video)=>videoObserver.observe(video));})();(function lazyLoadBackgrounds(){const elements=document.querySelectorAll('[data-bg-src]');if(!('IntersectionObserver' in window)||elements.length===0)return;const bgObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const el=entry.target;const bgSrc=el.dataset.bgSrc;if(bgSrc){el.style.backgroundImage=`url('${bgSrc}')`;el.classList.add('bg-loaded');delete el.dataset.bgSrc;bgObserver.unobserve(el);}}});},{rootMargin:getResponsiveMargin(60,80,100)});elements.forEach((el)=>bgObserver.observe(el));})();(function lazyLoadProcessWallpapers(){const processDetail=document.querySelector('.process-detail-panel');if(!processDetail)return;const wallpaperMap={'images/myprocess.webp':true,'images/brainstorm.webp':true,'images/design.webp':true,'images/website.webp':true,'images/salescopy.webp':true,'images/integrating.webp':true,};const processSection=document.querySelector('.process');if(!processSection)return;if('IntersectionObserver' in window){const processObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){Object.keys(wallpaperMap).forEach((url)=>{const img=new Image();img.src=url;});processObserver.unobserve(entry.target);}});},{rootMargin:getResponsiveMargin(120,160,200)});processObserver.observe(processSection);}})();(function lazyLoadBenefitCardVideos(){const benefitVideos=document.querySelectorAll('.card-video-full');if(!('IntersectionObserver' in window)||benefitVideos.length===0)return;const videoObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const video=entry.target;const source=video.querySelector('source');if(source&&source.src&&!source.dataset.loaded){video.preload='auto';source.dataset.loaded='true';video.load();}videoObserver.unobserve(video);}});},{rootMargin:getResponsiveMargin(80,120,150)});benefitVideos.forEach((video)=>{if(video.preload!=='auto'){video.preload='none';videoObserver.observe(video);}});})();(function optimizeImageLoading(){const lazyImages=document.querySelectorAll('img[loading="lazy"]');if(!('IntersectionObserver' in window)||lazyImages.length===0)return;const imageObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const img=entry.target;if(img.complete){img.classList.add('img-loaded');}else{img.addEventListener('load',()=>{img.classList.add('img-loaded');},{once:true});}imageObserver.unobserve(img);}});},{rootMargin:getResponsiveMargin(30,40,50)});lazyImages.forEach((img)=>imageObserver.observe(img));})();(function deferNonCriticalAssets(){document.addEventListener('DOMContentLoaded',()=>{document.body.classList.add('dom-ready');});window.addEventListener('load',()=>{document.body.classList.add('fully-loaded');});})();})();